#### 操作系统概述

程序执行的整个生命周期都受到操作系统的控制：建立程序的内存映像；内存的分配和释放、文件访问、中断处理

操作系统是一组程序，其作用包括：1、用户角度：为用户提供一个虚拟机 2、系统角度：提供一个资源管理器（硬件、软件）

操作系统的定义（**抓住两个角度**）：硬件之上的第一层软件（系统软件），有效管理控制计算机的软硬件资源，为用户提供使用计算机的良好接口

作业的概念来自批处理系统，分时系统没有作业的概念（什么是作业？组成？）

批处理：作业构成作业队列，依次完成（1、用户无法交互（用户无法交互意味着用户无法干预过程，即使执行错误也不能及时修改） 2、传统作业->命令文件的变化）

单道程序和多道程序：根据内存中同时有几个程序区分；对于单道处理程序，当该程序等待I/O事件时，CPU空闲；对于多道处理程序，当某个程序等待I/O事件时，其他程序可以占用CPU；多道程序的示意图如下：

![image-20231116195102565](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20231116195102565.png)

多道成批处理系统：吞吐量大、cpu利用率高、周转时间长

分时系统：进程共享计算机，按照时间片进行分配。并发与并行、多任务与多用户。

实时操作系统：响应快、延迟短、抗错、冗余

网络操作系统：提供网络通信和网络服务；两种工作模式：1、CS 2、P2P；

分布式操作系统：进程运行在多个机器上、逻辑上紧密耦合

![image-20231116200214277](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20231116200214277.png)

依赖于CPU的状态标识符PSW，CPU区分执行指令的是os还是用户进程，os可以执行特权指令。

CPU会处于两种工作状态（A核心态、B用户态）：A：特权指令、所有资源、改变处理器状态 B：非特权指令。随着权限上升，执行的指令集越来越大，且存在上下包含关系。

为了简化对内存的分配和管理，将内存进行分块。常用的内存保护机制：1、界限寄存器（可能触发越界中断） 2、存储保护键（属于程序）、存储块引入读保护位，0key不匹配也可以读 1 key不匹配时不可读 3、

![image-20231116201314443](C:\Users\hp\AppData\Roaming\Typora\typora-user-images\image-20231116201314443.png)

中断后做的事情：关中断、保存断点、识别中断事件、查中断向量表得到对应中断处理程序的入口地址、运行对应程序处理中断、处理完毕后返回并恢复现场、开中断。

重定位：相对地址->绝对地址（静态/动态：程序装入内存时进行/cpu每次访存时自动硬件进行）

现代操作系统的特征：虚拟、异步、共享、并发

操作系统的启动过程：初始化CS：IP寄存器->执行bios程序，也就是给cs:ip赋值，这段程序时固化的->bios进行硬件自检，并将bootloader加载到内存中并跳转->运行bootloader程序，将操作系统内核加载到内存中，并将控制权交给操作系统内核，进入保护模式、启动分页机制

